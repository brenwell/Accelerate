#!/bin/bash

PATH=`realpath .`/node_modules/.bin:$PATH


function public:start {
  rm -rf ./lib/
  webpack --progress --colors --watch --env.fileName 'accelerate.js' --env.libName 'accelerate'
}

function public:build {
  rm -rf ./lib/
  webpack --progress --colors --env.fileName 'accelerate.js' --env.libName 'accelerate'
  webpack --progress --colors -p --env.fileName 'accelerate.min.js' --env.libName 'accelerate'
}

function public:test {
  mocha-webpack --opts './test/mocha.opts' --glob "*.test.js" test || { echo 'Test failed' ; exit 1; }
}

function public:lint {
  eslint src --fix --max-warnings 0
}

function public:lint:watch {
  esw src --fix --watch -c ./.eslintrc.json
}

function public:docs {
  rm -rf ./docs && jsdoc -c ./jsdoc.json -R README.md
}

# ------------------------------------------
# DEFAULT public: list all possible commands
#
function public:help {
    echo "$0 <task> <args>"
    echo "Tasks:"
    compgen -A function | sed -En 's/public:(.*)/\1/p' | cat -n
}

# ---------- Do NOT edit below --------------

TIMEFORMAT="Task completed in %3lR"
time "public:${@:-help}" # make help default
